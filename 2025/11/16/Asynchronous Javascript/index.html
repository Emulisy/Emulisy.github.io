<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Asynchronous Javascript | Emulisy's blog</title><meta name="author" content="Emulisy"><meta name="copyright" content="Emulisy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Asynchronous JSJS has only one thread, so it cannot handle multiple tasks at the same time. But thanks to the non-blocking behaviour, we can carry on to the next task before the last task is finished,">
<meta property="og:type" content="article">
<meta property="og:title" content="Asynchronous Javascript">
<meta property="og:url" content="https://emulisy.github.io/2025/11/16/Asynchronous%20Javascript/index.html">
<meta property="og:site_name" content="Emulisy&#39;s blog">
<meta property="og:description" content="Asynchronous JSJS has only one thread, so it cannot handle multiple tasks at the same time. But thanks to the non-blocking behaviour, we can carry on to the next task before the last task is finished,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://emulisy.github.io/img/post-bg4.jpg">
<meta property="article:published_time" content="2025-11-16T06:02:08.000Z">
<meta property="article:modified_time" content="2025-11-24T03:45:09.111Z">
<meta property="article:author" content="Emulisy">
<meta property="article:tag" content="frontend">
<meta property="article:tag" content="前端">
<meta property="article:tag" content="javascript">
<meta property="article:tag" content="English">
<meta property="article:tag" content="编程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://emulisy.github.io/img/post-bg4.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Asynchronous Javascript",
  "url": "https://emulisy.github.io/2025/11/16/Asynchronous%20Javascript/",
  "image": "https://emulisy.github.io/img/post-bg4.jpg",
  "datePublished": "2025-11-16T06:02:08.000Z",
  "dateModified": "2025-11-24T03:45:09.111Z",
  "author": [
    {
      "@type": "Person",
      "name": "Emulisy",
      "url": "https://emulisy.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://emulisy.github.io/2025/11/16/Asynchronous%20Javascript/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Asynchronous Javascript',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/modify.css"><link rel="stylesheet" href="/css/quote.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div class="load-page" id="loading-box"><style>* { box-sizing: border-box; margin:0; padding:0; }

.load-page {
    position: fixed;
    top:0;
    left:0;
    width: 100vw;
    height: 100vh;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 9999;
    opacity: 1;
}

.load-container {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    padding-bottom: 3rem;
    width: 200px;
}

.load-1 {
    display: flex;
    gap: 2rem;
    position: relative;
}

#heart-wrapper { transform: rotate(-135deg) scale(0.9) translateY(0.4rem); }

#heart {
    position: relative;
    width: 1.8rem;
    height: 1.8rem;
    background: white;
    transform-origin: center;
    animation: heartbeat 1s ease-in-out infinite;
}

#heart::before, #heart::after {
    content: "";
    position: absolute;
    width: 1.8rem;
    height: 1.8rem;
    background: white;
    border-radius: 50%;
}

#heart::before { top: 0.9rem; left: 0; }
#heart::after { top: 0; left: 0.9rem; }

@keyframes heartbeat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

#x {
    width: 3rem;
    height: 3rem;
    position: relative;
    transition: transform 0.6s ease-in-out;
}

#rect1, #rect2 {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 3.2rem;
    height: 0.8rem;
    background: white;
    transform-origin: center center;
}

#rect1 { transform: translate(-50%, -50%) rotate(45deg); border-radius:1rem; width:3.5rem; }
#rect2 { transform: translate(-50%, -50%) rotate(-45deg); }

.load-2 {
    position: absolute;
    bottom: 0;
    height: 0.7rem;
    background: white;
    animation: load2 0.3s linear forwards;
    transition: height 0.3s ease-in, width 0.4s ease-in;
    transform-origin: center right;
}

@keyframes load2 {
    0% { transform: translateX(-15rem); width:0; }
    40% { transform: translateX(-7rem); width:14rem; }
    70% { transform: translateX(-3rem); width:10rem; }
    100% { transform: translateX(0); width:6rem; }
}
.load-rect-2 { position:fixed; bottom:0; height:0; width:100vw; background:white; z-index:10000; transition: height 0.15s ease-in; }
</style><div class="load-container"><div class="load-1"><div id="heart-wrapper"><div id="heart"></div></div><div id="x"><div id="rect1"></div><div id="rect2"></div></div></div><div class="load-2"></div></div></div><div class="load-rect-2"><script>(function(){
    const startTime = Date.now();
    let i = 0;
    const $loadingBox = document.getElementById("loading-box");
    const rect1 = document.querySelector(".load-2");
    const rect2 = document.querySelector(".load-rect-2");

    rect1.addEventListener("animationend", () => {
        rect1.style.animation = "none";
        rect1.style.width = "5.5rem"
    })

    function rotateX() {
        const xbox = document.querySelector("#x");
        if(xbox){ i++; xbox.style.transform = `rotate(${i*45}deg)`; }
    }

    function loadComplete() { //animation when loading is completed
        rect1.style.width = "10rem";
        setTimeout(() => {
            rect1.style.height = "100vh";
        }, 350);
        setTimeout(() => {
            rect2.style.height = "100vh";
        }, 700);
        setTimeout(() => {
            if ($loadingBox) {
                $loadingBox.style.display = "none";
            }
            if (rect2) {
                rect2.style.top = "0";
                rect2.style.height = "0";
            }
        }, 1000)
    }

    window.addEventListener("DOMContentLoaded", ()=>{
        const timePassed = Date.now() - startTime;
        const minDisplay = 2000;  // minimum loading time
        const timeRemaining = Math.max(0, minDisplay - timePassed);
        setTimeout(loadComplete, timeRemaining);
    });

    setInterval(rotateX, 1000);

    // PJAX support
    if(!window.theme || !theme.pjax || !theme.pjax.enable){
        if(window.btf){
            btf.addGlobalFn("pjaxSend",()=>{ $loadingBox.style.display="flex"; $loadingBox.style.opacity="1"; },"preloader_init");
            btf.addGlobalFn("pjaxComplete",()=>{
                $loadingBox.style.opacity="0";
                setTimeout(()=>{ $loadingBox.style.display="none"; }, 200);
            },"preloader_end");
        }
    }
})();</script></div><div id="web_bg" style="background-image: url(/img/home-bg.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> music</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/post-bg4.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Emulisy's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Asynchronous Javascript</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> music</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Asynchronous Javascript</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-11-16T06:02:08.000Z" title="发表于 2025-11-16 14:02:08">2025-11-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-24T03:45:09.111Z" title="更新于 2025-11-24 11:45:09">2025-11-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF%E5%8D%9A%E5%AE%A2-tech-blog/">技术博客(tech blog)</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">1.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>11分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="Asynchronous-JS"><a href="#Asynchronous-JS" class="headerlink" title="Asynchronous JS"></a>Asynchronous JS</h2><p>JS has only one thread, so it cannot handle multiple tasks at the same time. But thanks to the non-blocking behaviour, we can carry on to the next task before the last task is finished, this is Asynchronous Javascript.</p>
<h3 id="HTTP-HTTPS"><a href="#HTTP-HTTPS" class="headerlink" title="HTTP&#x2F;HTTPS"></a>HTTP&#x2F;HTTPS</h3><p>When making communication with a server, we use HTTP&#x2F;HTTPS requests.</p>
<p><strong>What happens when we make an HTTP&#x2F;HTTPS request</strong>:</p>
<ol>
<li><p>Parse URL and check cache: to make a request we need to know the url of the server, so we need to parse the URL(<code>https://example.com:443/path?query=foo#hash </code>) into:</p>
<ul>
<li><p>protocol: https&#x2F;http</p>
</li>
<li><p>host: example.com</p>
</li>
<li><p>port: 443 (default for HTTPS) or 80 (default for HTTP)</p>
</li>
<li><p>path: &#x2F;path</p>
</li>
<li><p>query string: ?query&#x3D;foo</p>
</li>
</ul>
</li>
<li><p>DNS(Domain Name System) lookup: using DNS to get the server’s ip address.</p>
</li>
<li><p>TCP and three-way handshake: SYN SYN-ACK ACK</p>
</li>
<li><p>TLS handshake(optional): for HTTPS only, to encrypt the request. </p>
</li>
<li><p><strong>Send request</strong></p>
</li>
<li><p><strong>Server receive and process request</strong></p>
</li>
<li><p><strong>Server return a response to be parsed by browser</strong></p>
</li>
</ol>
<p>The key here is to send and receive the HTTP&#x2F;HTTPS request via the browser. </p>
<p><strong>So what is inside the request and the server’s response?</strong></p>
<blockquote>
<p><strong>Differ domain. ip address and URL</strong>:</p>
<ul>
<li>IP Address: The real numeric address of the server</li>
<li>Domain: The human-readable name mapped to an ip address. The mapping is stored in DNS server.</li>
<li>URL(Uniform Resource Locator): The complete address including protocol, domain, path, etc.</li>
</ul>
</blockquote>
<h3 id="HTTP-Request"><a href="#HTTP-Request" class="headerlink" title="HTTP Request"></a>HTTP Request</h3><p>Inside the HTTP request we have:</p>
<ul>
<li><p><strong>Request Line: This is the first line of the request, including:</strong></p>
<ul>
<li>Request Method: GET&#x2F;POST&#x2F;DELETE&#x2F;PATCH&#x2F;PUT&#x2F;…</li>
<li>Path&#x2F;URL</li>
<li>Version: HTTP&#x2F;HTTPS version</li>
</ul>
<p>eg: <code>GET /search?q=monash HTTP/1.1</code></p>
</li>
<li><p><strong>Request Headers: give the server context and metadata. Common headers are:</strong></p>
<ul>
<li>Host: tell the server which domain you want to search, as most server hosts multiple domains.</li>
<li>User-agent: Give information on your browser, your operating system, etc.</li>
<li>Accept: Tells the server what format your browser is willing to accept. Like JSON&#x2F;image&#x2F;HTML&#x2F;…</li>
<li>Authorization: Provide information on who you are. Like API keys.</li>
</ul>
</li>
<li><p><strong>Request Body: Optional. Usually PUT&#x2F;POST&#x2F;PATCH requests have request body.</strong></p>
<ul>
<li>It may contain form data, JSON files or other file uploads.</li>
</ul>
</li>
</ul>
<h3 id="HTTP-Response"><a href="#HTTP-Response" class="headerlink" title="HTTP Response"></a>HTTP Response</h3><p>A HTTP Response is usually consists of:</p>
<ul>
<li><strong>Status line</strong>: <code>HTTP/1.1 200 OK</code> containing:<ul>
<li>HTTP&#x2F;HTTPS Version</li>
<li>Status Code: Success&#x2F;Redirect&#x2F;Server Error&#x2F;Client Error</li>
<li>Status Text: human-readable text, Like <code>200 OK</code></li>
</ul>
</li>
</ul>
<blockquote>

<h3 id="Status-Codes"><a href="#Status-Codes" class="headerlink" title="Status Codes:"></a>Status Codes:</h3><p><strong>2xx — Success</strong></p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody><tr>
<td>200 OK</td>
<td>Standard success</td>
</tr>
<tr>
<td>201 Created</td>
<td>New resource created (POST)</td>
</tr>
<tr>
<td>204 No Content</td>
<td>Success, but no body</td>
</tr>
</tbody></table>
<p><strong>3xx — Redirects</strong></p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody><tr>
<td>301 Moved Permanently</td>
<td>Permanent redirect</td>
</tr>
<tr>
<td>302 Found</td>
<td>Temporary redirect</td>
</tr>
<tr>
<td>304 Not Modified</td>
<td>Browser can use cache</td>
</tr>
</tbody></table>
<hr>
<p><strong>4xx — Client Errors</strong></p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody><tr>
<td>400 Bad Request</td>
<td>Invalid request (wrong syntax)</td>
</tr>
<tr>
<td>401 Unauthorized</td>
<td>Need login token</td>
</tr>
<tr>
<td>403 Forbidden</td>
<td>You are not allowed</td>
</tr>
<tr>
<td>404 Not Found</td>
<td>Page doesn’t exist</td>
</tr>
<tr>
<td>429 Too Many Requests</td>
<td>Rate limit</td>
</tr>
</tbody></table>
<hr>
<p><strong>5xx — Server Errors</strong></p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody><tr>
<td>500 Internal Server Error</td>
<td>Server crashed</td>
</tr>
<tr>
<td>502 Bad Gateway</td>
<td>Reverse proxy problem</td>
</tr>
<tr>
<td>503 Service Unavailable</td>
<td>Server temporarily down</td>
</tr>
<tr>
<td>504 Gateway Timeout</td>
<td>Upstream server took too long</td>
</tr>
</tbody></table>
</blockquote>

<ul>
<li><strong>Response Headers: Headers give metadata about the response, including content information, cache control, authentication, etc.</strong></li>
<li><strong>Response Body</strong>: Optional. contains real content, including file response, JSON API response, or empty response for <code>204 No Content</code></li>
</ul>
<h2 id="AJAX-Asynchronous-JS-and-XML"><a href="#AJAX-Asynchronous-JS-and-XML" class="headerlink" title="AJAX (Asynchronous JS and XML)"></a>AJAX (Asynchronous JS and XML)</h2><p><strong>AJAX is a technique that allows a webpage to request data from a server without reloading the entire page.</strong></p>
<p>It lets websites update only part of the page (like search suggestions, comments, likes) while the rest stays the same.</p>
<p>For now, the most used AJAX technique to communicate with servers is XHR(XMLHttpRequest) and Fetch API.</p>
<h3 id="Using-XHR"><a href="#Using-XHR" class="headerlink" title="Using XHR"></a>Using XHR</h3><p><strong>Steps:</strong></p>
<ol>
<li>Create XHR object<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br></pre></td></tr></table></figure></li>
<li>Set up the request <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">open</span>(method, url)</span><br></pre></td></tr></table></figure></li>
<li>Listen for load event <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">addEventListener</span>(<span class="string">&quot;load&quot;</span>, <span class="function">()=&gt;</span>&#123;&#125;);</span><br><span class="line"><span class="comment">//or</span></span><br><span class="line">xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Response:&quot;</span>, xhr.<span class="property">responseText</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Request failed:&quot;</span>, xhr.<span class="property">status</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>Send the request <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">send</span>()</span><br></pre></td></tr></table></figure>
 If using POST request to send data <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;<span class="attr">data</span>: <span class="string">&quot;data&quot;</span>&#125;))</span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>

<p><strong>Useful properties</strong>:</p>
<ul>
<li><code>xhr.response</code>:could be JSON or other file types</li>
<li><code>xhr.status</code>: the response status, like 200 OK</li>
<li>Progress event:  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="property">onprogress</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Loaded: <span class="subst">$&#123;e.loaded&#125;</span> / <span class="subst">$&#123;e.total&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Error event:  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="property">onerror</span> = <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Network error&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>

<h3 id="Callback-Hell"><a href="#Callback-Hell" class="headerlink" title="Callback Hell"></a>Callback Hell</h3><p>In real development, we may need nested callback functions, that is to use the result of the inner callback function as parameter for the outer ones. Doing so makes the code very hard to maintain and read.</p>
<h2 id="Promise-and-Fetch"><a href="#Promise-and-Fetch" class="headerlink" title="Promise and Fetch"></a>Promise and Fetch</h2><p>A Promise is an object that represents a value that may arrive now, later, or never. </p>
<p>A promise can be in three states: <code>pending</code> <code>fulfilled</code> and <code>rejected</code></p>
<ul>
<li><code>pending</code>: the promise hasn’t returned a value yet</li>
<li><code>fulfilled</code>: the promise returned a value</li>
<li><code>rejected</code>: the promise returned an error</li>
</ul>
<p>We can create a promise object manually, but usually the promises are created automatically when we are dealing with asynchronous operations, like fetch.</p>
<h3 id="Chaining-a-promise"><a href="#Chaining-a-promise" class="headerlink" title="Chaining a promise"></a>Chaining a promise</h3><p>We can handle the promise using <code>then</code>, <code>catch</code> and <code>finally</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">promise</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> data = response.<span class="property">json</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">message</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">finally</span>()</span><br></pre></td></tr></table></figure>
<ul>
<li><code>.then</code> happens when the promise is fulfilled, by default it returns a new promise. That is what enables promise chaining:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">promise</span><br><span class="line">    .<span class="title function_">then</span>()</span><br><span class="line">    .<span class="title function_">then</span>()</span><br><span class="line">    .<span class="title function_">then</span>()</span><br><span class="line">    .<span class="title function_">catch</span>()</span><br><span class="line">    .<span class="title function_">finally</span>()</span><br></pre></td></tr></table></figure>
<ul>
<li><code>.catch</code> happens when any promise in the chain is rejected.</li>
<li><code>.finally</code> happens after the promise is fulfilled or rejected</li>
</ul>
<h3 id="Fetch"><a href="#Fetch" class="headerlink" title="Fetch"></a>Fetch</h3><p><code>fetch()</code> is a modern, promise-based API used to make HTTP requests (GET, POST, PUT, DELETE, etc.).</p>
<p>By default, a <code>fetch()</code> returns a promise.</p>
<p>The syntax of a fetch request is :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(url, &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>,           <span class="comment">// HTTP Method</span></span><br><span class="line">  <span class="attr">headers</span>: &#123;&#125;,             <span class="comment">// Optional headers</span></span><br><span class="line">  <span class="attr">body</span>: &#123;&#125;,                <span class="comment">// Body for POST/PUT</span></span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;cors&quot;</span>,            <span class="comment">// CORS</span></span><br><span class="line">  <span class="attr">credentials</span>: <span class="string">&quot;include&quot;</span>,  <span class="comment">// Cookies</span></span><br><span class="line">  <span class="attr">cache</span>: <span class="string">&quot;no-cache&quot;</span>,       <span class="comment">// Cache behavior</span></span><br><span class="line">  <span class="attr">redirect</span>: <span class="string">&quot;follow&quot;</span>       <span class="comment">// Redirect behavior</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Doing so returns a promise, and if successful, the promise will return an http response.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(url)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!response.<span class="property">ok</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">status</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span>(response.<span class="title function_">json</span>());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Note that event if the request is not successful, as long as the server returns a response, the fetch promise is fulfilled.</p>
<h3 id="Error-Handling"><a href="#Error-Handling" class="headerlink" title="Error Handling"></a>Error Handling</h3><p>For now, if the fetch promise is rejected, the error can be handled by <code>.catch</code>. This usually happens when the request is CORS blocked, or have no internet connections.</p>
<p>But receiving a failed response, like 404, is also not desirable. So we can throw an error manually when that happens:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;/api/data&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!res.<span class="property">ok</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`HTTP error! Status: <span class="subst">$&#123;res.status&#125;</span>`</span>); <span class="comment">//throw the error</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">json</span>();</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Success:&quot;</span>, data);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Network or HTTP error:&quot;</span>, err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>The error object</strong>: there are many ways to create an error object manually:</p>
<ul>
<li>Basic error:	throw new Error(“message”)</li>
<li>Specific type:	throw new TypeError(“msg”), there are also SyntaxError, ReferenceError, etc</li>
<li>Custom class:	class MyError extends Error {…}</li>
</ul>
</blockquote>
<hr>
<h3 id="Async-Await"><a href="#Async-Await" class="headerlink" title="Async Await"></a>Async Await</h3><p>In the previous section, we used promise chaining to handle async operations, but now we have a more elegant way of writing it.</p>
<p>Syntax:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>When we add <code>async</code> to a function, that function will automatically return a promise.<br>We can use await to get the result of the promise.</p>
<p>It can be used in fetch operations:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getIP</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;https://ipapi.co/json/&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getIP</span>();</span><br></pre></td></tr></table></figure>
<p>We can assume that await is just like <code>.then()</code> </p>
<h3 id="try…catch"><a href="#try…catch" class="headerlink" title="try…catch"></a>try…catch</h3><p>In promise chaining we use <code>.catch</code> for error handling, in async-await, we also have similar feature.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">loadData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;https://wrong-url&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error:&quot;</span>, err);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">loadData</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>try catch</code> is just like <code>.catch()</code> in promise chaining.</p>
<blockquote>
<p><em>Tips:</em></p>
<ul>
<li>only use await in an <code>async</code> function</li>
<li>await most be followed with a promise</li>
<li>async functions always return a promise</li>
<li>await doesn’t block the main thread, it only stops the current function</li>
</ul>
</blockquote>
<h3 id="Running-multiple-promises"><a href="#Running-multiple-promises" class="headerlink" title="Running multiple promises"></a>Running multiple promises</h3><p>If we simply use promise chaining, or async await, the promises are handled one by one. But sometimes, when the promises do not rely on each other, and the order doesn’t matter, we want to get the result of multiple promises at once.</p>
<ul>
<li><strong>Using <code>Promise.all</code></strong>:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&quot;https://ipapi.co/json/&quot;</span>),</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&quot;https://api.github.com/users/octocat&quot;</span>),</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&quot;https://api.publicapis.org/entries&quot;</span>)</span><br><span class="line">]).<span class="title function_">then</span>(<span class="title function_">async</span> ([res1, res2, res3]) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> data1 = <span class="keyword">await</span> res1.<span class="title function_">json</span>();</span><br><span class="line">  <span class="keyword">const</span> data2 = <span class="keyword">await</span> res2.<span class="title function_">json</span>();</span><br><span class="line">  <span class="keyword">const</span> data3 = <span class="keyword">await</span> res3.<span class="title function_">json</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data1, data2, data3);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Using it, we can get the result of the three results at once. It returns an array of all promise results. </p>
<ul>
<li><strong>Using <code>Promise.allSettled()</code></strong></li>
</ul>
<p>However, if any of the promises is rejected, the <code>Promise.all</code> will be rejected as a whole. </p>
<p>In order to get the results even if some promises are rejected, we can use <code>Promise.allSettled()</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">allSettled</span>([p1, p2, p3])</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(results);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Using <code>Promise.race()</code></strong></li>
</ul>
<p>Given an array of promises, <code>Promise.race()</code> returns the that promise that gives an result(no matter rejected or fulfilled).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">race</span>([slow, fast]).<span class="title function_">then</span>(<span class="variable language_">console</span>.<span class="property">log</span>); <span class="comment">// &quot;fast&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Using <code>Promise.any()</code></strong></li>
</ul>
<p>Given an array of promises, <code>Promise.any()</code> returns the first fulfilled promise. If all the promises are rejected, it will return a <code>AggregateError</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&quot;fail 1&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> p2 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&quot;success!&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> p3 = <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&quot;fail 2&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">any</span>([p1, p2, p3])</span><br><span class="line">  .<span class="title function_">then</span>(<span class="variable language_">console</span>.<span class="property">log</span>)   <span class="comment">// &quot;success!&quot;</span></span><br><span class="line">  .<span class="title function_">catch</span>(<span class="variable language_">console</span>.<span class="property">error</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Top-level-await"><a href="#Top-level-await" class="headerlink" title="Top level await"></a>Top level await</h3><p>After ES2022, we can use <code>await</code> outside the <code>async</code> function. That is top level await. But there are restraints:</p>
<p><strong>Top level await can only be used in modules, this includes:</strong></p>
<ul>
<li><code>.mjs</code> file</li>
<li><code>js</code> files with <code>&lt;script type=&quot;module&quot;&gt;</code> or <code>&quot;type&quot;: &quot;module&quot;</code></li>
</ul>
<p>It’s usage is quite the same, following the <code>await</code> should be a promise.</p>
<p>Note that the top level <code>await</code> will block the module from loading. </p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/frontend/">frontend</a><a class="post-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF/">前端</a><a class="post-meta__tags" href="/tags/javascript/">javascript</a><a class="post-meta__tags" href="/tags/English/">English</a><a class="post-meta__tags" href="/tags/%E7%BC%96%E7%A8%8B/">编程</a></div><div class="post-share"><div class="social-share" data-image="/img/post-bg4.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/11/OOP%20in%20Javascript/" title="Object Oriented Programming in JS"><img class="cover" src="/img/post-bg1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Object Oriented Programming in JS</div></div><div class="info-2"><div class="info-item-1">PrototypeIn classic Object Oriented Programming, we have class as templates and objects are instantiated from classes. In Javascript, oop is different. In js, we have such things called prototype. We can create objects and delegate them to the linked prototype. prototype contains methods that are accessible to all objects that are linked to it, just like class methods in classes. prototype itself is an object, it usually has this structure: 1234A.prototype = &#123;  constructor: A, ...</div></div></div></a><a class="pagination-related" href="/2026/01/12/BlockChain%20-%20basic%20concepts/" title="Blcokchain - Basic Concepts"><img class="cover" src="/img/post-bg3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Blcokchain - Basic Concepts</div></div><div class="info-2"><div class="info-item-1">Blockchain Basics1. What is Blockchain?Blockchain is a decentralized, distributed ledger technology used to record information securely, transparently, and immutably across multiple participants. It consists of a series of chronologically linked “blocks,” each containing transaction data and the hash of the previous block, ensuring the integrity of the chain. Key Features of Blockchain Immutable: Once data is written to the chain, it is nearly impossible to alter Transparent: Transactions on...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/10/12/Falsy%20and%20Truthy%20in%20JS/" title="Falsy and Truthy in JS"><img class="cover" src="/img/post-bg4.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-12</div><div class="info-item-2">Falsy and Truthy in JS</div></div><div class="info-2"><div class="info-item-1">Difference between == and ===In a word, == tries to covert the two values to the same type, and then compare its value. 1&quot;10&quot; == 10; //true  But === requires the two values to have the same value and the same type: 12&quot;10&quot; === 10; //false&quot;10&quot; === &quot;10&quot;; //true  == is not so safe to use, so we usually use === or !==.  How to determine if a value is true or falseIn JS, whenever we need to transfer a value into a boolean, the value will be determined as...</div></div></div></a><a class="pagination-related" href="/2025/10/09/Javascript%20Engine/" title="Javascript Engine"><img class="cover" src="/img/post-bg2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-09</div><div class="info-item-2">Javascript Engine</div></div><div class="info-2"><div class="info-item-1">Javascript overview High-level: As a high level language, unlike C language, js arranges garbage collection and memory allocation for us. Just-in-time compiled:  Multi-paradigm: JS supports procedural, object-oriented and functional programming, unlike C which does not support OOP(object-oriented programming), making JS more flexible and versatile. Single threaded with non-blocking event loop: enables concurrency, which is handling multiple tasks at the same time.   Compiled language vs...</div></div></div></a><a class="pagination-related" href="/2025/09/02/Javascript%20Fundamentals/" title="Javascript Fundamentals"><img class="cover" src="/img/post-bg1.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-02</div><div class="info-item-2">Javascript Fundamentals</div></div><div class="info-2"><div class="info-item-1">Primitive types string number bigInt boolean  undefined null symbol   NumbersIn JS, numbers are always 64-bit Floating Point!! Therefor precision exist to avoid overflow:  Integer precision: int are accurate within the scope (Number.MAX_SAFE_INTEGER, Number.MIN_SAFE_INTEGER) Floating-point imprecision: Because numbers are binary floats, decimals like 0.1 cannot be represented accurately. So float point arithmetic is not always precise.1console.log(0.1 + 0.2 === 0.3)//false So how to fix...</div></div></div></a><a class="pagination-related" href="/2025/10/12/Spread%20and%20Rest%20Operator/" title="Spread and Rest Operator - ES6"><img class="cover" src="/img/post-bg1.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-12</div><div class="info-item-2">Spread and Rest Operator - ES6</div></div><div class="info-2"><div class="info-item-1">ES6 Spread and Rest (...)The three dots ... in JavaScript can represent two different concepts:  Spread Operator – expands data Rest Pattern &#x2F; Rest Parameters – gathers data  They look identical but behave in opposite directions depending on where they’re used.  Concept Overview   Feature Purpose Context    Spread (...) Expands an iterable into individual elements When passing or copying data   Rest (...) Collects multiple elements into one array&#x2F;object When receiving or...</div></div></div></a><a class="pagination-related" href="/2025/11/11/OOP%20in%20Javascript/" title="Object Oriented Programming in JS"><img class="cover" src="/img/post-bg1.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-11</div><div class="info-item-2">Object Oriented Programming in JS</div></div><div class="info-2"><div class="info-item-1">PrototypeIn classic Object Oriented Programming, we have class as templates and objects are instantiated from classes. In Javascript, oop is different. In js, we have such things called prototype. We can create objects and delegate them to the linked prototype. prototype contains methods that are accessible to all objects that are linked to it, just like class methods in classes. prototype itself is an object, it usually has this structure: 1234A.prototype = &#123;  constructor: A, ...</div></div></div></a><a class="pagination-related" href="/2025/11/04/Using%20Intersection%20Observer/" title="Intersection Observer API"><img class="cover" src="/img/post-bg3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-04</div><div class="info-item-2">Intersection Observer API</div></div><div class="info-2"><div class="info-item-1">The Intersection Observer LiteralCreating a new Intersection Observer using constructor: 1const observer = new IntersectionObserver(callback, options);  callback: The function to be called whenever the target enter&#x2F;leave the intersection area. options: An object that controls the condition of triggering the callback function.  options ObjectThe option object looks like this: 12345const option = &#123;    root: null,    rootMargin: &quot;0px&quot;,    thereshold: [0, 0.1]&#125;  root:...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Emulisy</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Emulisy"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Emulisy" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:ianzhang2088979637@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">我的避风港——存储了我的技术博客，读书笔记还有杂谈等~</div></div><div class="card-widget visitor-location-map" id="visitor-location-map"><div class="item-headline"><i class="fas fa-map-marker-alt"></i><span>Your Location</span></div><div class="item-content"><div id="location-container" style="width: 100%; display: flex; flex-direction: column; padding: 10px;">
  <div id="map-display" style="margin-bottom: 10px; min-height: 150px; background: #f0f0f0; border-radius: 12px; display: flex; align-items: center; justify-content: center;">
    <i class="fas fa-spinner fa-spin"></i>
  </div>
  <div id="location-text" style="font-size: 14px; font-weight: bold;">Locating...</div>
  <div id="location-detail" style="font-size: 12px; color: #888; margin-top: 5px;"></div>
</div>
<script>
  function updateVisitorMap() {
    fetch('https://ipwho.is/')
      .then(res => res.json())
      .then(data => {
        if (!data.success) throw new Error();

        const textEl = document.getElementById('location-text');
        const detailEl = document.getElementById('location-detail');
        const mapEl = document.getElementById('map-display');

        const { country, region, city, latitude, longitude, country_code } = data;

        const mapUrl = `https://static-maps.yandex.ru/1.x/?lang=en-US&ll=${longitude},${latitude}&z=4&l=map&size=250,180&pt=${longitude},${latitude},pm2rdm`;

        mapEl.innerHTML = `<img src="${mapUrl}" style="border-radius:12px; width:100%; height:auto; box-shadow: 0 4px 8px rgba(0,0,0,0.1); transition: all 0.3s;">`;

        if (country_code === 'CN') {
          textEl.innerHTML = `欢迎来自 ${region} 的朋友`;
          detailEl.innerHTML = `${city} · 中国`;
        } else {
          textEl.innerHTML = `Welcome, friend from ${country}`;
          detailEl.innerHTML = `${region} · ${city}`;
        }
      })
      .catch(() => {
        document.getElementById('location-text').innerHTML = "Can't find your location, but welcome to my blog!";
      });
  }
  window.addEventListener('load', updateVisitorMap);
</script>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Asynchronous-JS"><span class="toc-number">1.</span> <span class="toc-text">Asynchronous JS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-HTTPS"><span class="toc-number">1.1.</span> <span class="toc-text">HTTP&#x2F;HTTPS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-Request"><span class="toc-number">1.2.</span> <span class="toc-text">HTTP Request</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-Response"><span class="toc-number">1.3.</span> <span class="toc-text">HTTP Response</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Status-Codes"><span class="toc-number">1.4.</span> <span class="toc-text">Status Codes:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AJAX-Asynchronous-JS-and-XML"><span class="toc-number">2.</span> <span class="toc-text">AJAX (Asynchronous JS and XML)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-XHR"><span class="toc-number">2.1.</span> <span class="toc-text">Using XHR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Callback-Hell"><span class="toc-number">2.2.</span> <span class="toc-text">Callback Hell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Promise-and-Fetch"><span class="toc-number">3.</span> <span class="toc-text">Promise and Fetch</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Chaining-a-promise"><span class="toc-number">3.1.</span> <span class="toc-text">Chaining a promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fetch"><span class="toc-number">3.2.</span> <span class="toc-text">Fetch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Error-Handling"><span class="toc-number">3.3.</span> <span class="toc-text">Error Handling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Async-Await"><span class="toc-number">3.4.</span> <span class="toc-text">Async Await</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#try%E2%80%A6catch"><span class="toc-number">3.5.</span> <span class="toc-text">try…catch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Running-multiple-promises"><span class="toc-number">3.6.</span> <span class="toc-text">Running multiple promises</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Top-level-await"><span class="toc-number">3.7.</span> <span class="toc-text">Top level await</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/13/Ethereum%20-%20basic%20concepts/" title="Ethereum - basic concepts"><img src="/img/post-bg2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ethereum - basic concepts"/></a><div class="content"><a class="title" href="/2026/01/13/Ethereum%20-%20basic%20concepts/" title="Ethereum - basic concepts">Ethereum - basic concepts</a><time datetime="2026-01-13T12:40:51.000Z" title="发表于 2026-01-13 20:40:51">2026-01-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/12/BlockChain%20-%20basic%20concepts/" title="Blcokchain - Basic Concepts"><img src="/img/post-bg3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Blcokchain - Basic Concepts"/></a><div class="content"><a class="title" href="/2026/01/12/BlockChain%20-%20basic%20concepts/" title="Blcokchain - Basic Concepts">Blcokchain - Basic Concepts</a><time datetime="2026-01-12T09:38:41.000Z" title="发表于 2026-01-12 17:38:41">2026-01-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/16/Asynchronous%20Javascript/" title="Asynchronous Javascript"><img src="/img/post-bg4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Asynchronous Javascript"/></a><div class="content"><a class="title" href="/2025/11/16/Asynchronous%20Javascript/" title="Asynchronous Javascript">Asynchronous Javascript</a><time datetime="2025-11-16T06:02:08.000Z" title="发表于 2025-11-16 14:02:08">2025-11-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/11/OOP%20in%20Javascript/" title="Object Oriented Programming in JS"><img src="/img/post-bg1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Object Oriented Programming in JS"/></a><div class="content"><a class="title" href="/2025/11/11/OOP%20in%20Javascript/" title="Object Oriented Programming in JS">Object Oriented Programming in JS</a><time datetime="2025-11-11T01:32:21.000Z" title="发表于 2025-11-11 09:32:21">2025-11-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/06/Hexo%20Butterfly%20%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A0%E8%BD%BD%E9%A1%B5%E9%9D%A2/" title="在Hexo Butterfly 里添加自定义加载页面"><img src="/img/post-bg2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="在Hexo Butterfly 里添加自定义加载页面"/></a><div class="content"><a class="title" href="/2025/11/06/Hexo%20Butterfly%20%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A0%E8%BD%BD%E9%A1%B5%E9%9D%A2/" title="在Hexo Butterfly 里添加自定义加载页面">在Hexo Butterfly 里添加自定义加载页面</a><time datetime="2025-11-06T13:13:46.000Z" title="发表于 2025-11-06 21:13:46">2025-11-06</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div class="copyright">&copy;2025 - 2026 By Emulisy</div><div class="footer_custom_text"><p style="font-size: 20px; font-family: sans-serif;">
  我永远喜欢水上由岐~
</p> <p style="text-align: center;">
  <a target="_blank" href="https://hexo.io/">
    <img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo">
  </a>&nbsp;
  <a target="_blank" href="https://butterfly.js.org/">
    <img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用Butterfly">
  </a>
</p>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = {"mapping":"url","strict":0,"reactions_enabled":1,"emit_metadata":0,"input_position":"bottom","lang":"en"}

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'Emulisy/Emulisy.github.io',
      'data-repo-id': 'R_kgDOPAbCig',
      'data-category-id': 'DIC_kwDOPAbCis4C05wb',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script src="/scripts/quote.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="D'où venons-nous ?,Que sommes-nous ?,Où allons-nous ?" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for an article~" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>